<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>scene4_before</title>
    <script src="https://cdn.jsdelivr.net/npm/three@0.105.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/panolens@0.12.0/build/panolens.min.js"></script>
    <link rel="stylesheet" href="./scss/scene_common.css" />
    <link rel="stylesheet" href="./scss/easter-egg.css" />
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
      }
      .scene-page {
        position: relative;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }
      #viewer {
        width: 100%;
        height: 100%;
      }
    </style>
  </head>
  <body>
    <audio id="bgm" src="./BGM/sampung.mp3" loop preload="auto"></audio>
    <main class="scene-page">
      <div id="viewer">
        <button
          id="easter-egg"
          type="button"
          aria-label="비상 탈출"
          data-next="../exit/chapter2_exit.html"
          data-yaw="-46"
          data-pitch="75"
        ></button>
      </div>

      <button id="next-button"></button>
    </main>
    <script src="./js/scene_common.js"></script>
    <script src="./js/easter-egg.js" defer></script>

    <script>
      initPanorama(
        './images/panorama/scene5_before.webp',
        'scene5_after.html',
        true // ✅ 이스터에그 포함 여부
      );
      document.addEventListener('DOMContentLoaded', () => {
        const bgm = document.getElementById('bgm');
        document.body.addEventListener(
          'click',
          () => {
            bgm.play().catch((e) => console.log('Autoplay was prevented.'));
          },
          { once: true }
        );
      });
    </script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const delayTime = 300000; // 5분 = 300,000 밀리초 3분 = 180,000 밀리초 1분 = 60,000 밀리초

        // main.html로 이동할 상대 경로 설정
        const targetPageURL = '../../../main.html';

        function redirectToMain() {
          console.log(`페이지가 5분 후 ${targetPageURL}로 이동합니다.`);

          setTimeout(function () {
            window.location.href = targetPageURL;
          }, delayTime);
        }

        redirectToMain();
      });
    </script>
  </body>
</html>
